<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Colladraw Lib</title>

    <link rel="stylesheet" href="./build/module/lib/css/optimized-canvas.css">

    <script defer type="module">
      import Colladraw, {CanvasText} from "./build/module/index.js";

      const canvas = document.querySelector('canvas');
      window.colladraw = new Colladraw(canvas);

      let selectedText = null;

      // element-clicked, element-selected, element-deselected, element-moved, element-transform, element-created
      canvas.addEventListener('element-clicked', (e) => {
        console.log('element-clicked', e.detail);
      });

      canvas.addEventListener('element-selected', (e) => {
        console.log('element-selected', e.detail);

        if (e.detail.element instanceof CanvasText) {
          selectedText = e.detail.element;
        }
      });

      canvas.addEventListener('element-deselected', (e) => {
        console.log('element-deselected', e.detail);
        selectedText = null;
      });

      canvas.addEventListener('element-moved', (e) => {
        console.log('element-moved', e.detail);
      });

      canvas.addEventListener('element-transform', (e) => {
        console.log('element-transform', e.detail);
      });

      canvas.addEventListener('element-created', (e) => {
        console.log('element-created', e.detail);
      });

      document.querySelector('#text-input').addEventListener('input', (e) => {
        if (selectedText) {
          selectedText.text = e.target.value;
          colladraw.draw()
        }
      });
    </script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        html, body, canvas {
            width: 100%;
            height: 100%;
        }

        header {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 9999;
            width: 100vw;
            display: flex;
            justify-content: space-between;
        }

        label {
            display: none;
        }
    </style>
</head>
<body>
<canvas></canvas>
<header>
    <label for="text-input"></label><input type="text" id="text-input" placeholder="Type here...">
    <div class="buttons">
        <button onclick="window.saved = colladraw.toJSON()">Save</button>
        <button onclick="colladraw.clear()">Clear</button>
        <button onclick="colladraw.load(window.saved)">Load</button>
        <button onclick="colladraw.savePDF()">Save PDF</button>
    </div>
</header>
</body>
</html>
